CREATE TABLE t1(a INTEGER);
INSERT INTO t1 VALUES(11),(12),(13),(14),(15),(16),(17),(18),(19);
CREATE TABLE t2(a INTEGER);
INSERT INTO t2 VALUES(21),(22),(23),(24),(25),(26),(27);
SELECT * FROM t1 ORDER BY a LIMIT 6;
a
11
12
13
14
15
16
SELECT * FROM t1 ORDER BY a  LIMIT 5 OFFSET 1;
a
12
13
14
15
16
(SELECT * FROM t1 ORDER BY a LIMIT 7) ORDER BY a DESC LIMIT 4;
a
17
16
15
14
(SELECT * FROM t1 ORDER BY a LIMIT 7 OFFSET 1) ORDER BY a DESC LIMIT 4 OFFSET 2;
a
16
15
14
13
(SELECT * FROM t1 ORDER BY a DESC LIMIT 7) ORDER BY a LIMIT 4;
a
13
14
15
16
(SELECT * FROM t1 ORDER BY a DESC LIMIT 7 OFFSET 1) ORDER BY a LIMIT 4 OFFSET 2;
a
14
15
16
17
SELECT * FROM t1 UNION SELECT * FROM t2 ORDER BY a LIMIT 5;
a
11
12
13
14
15
SELECT * FROM t1 UNION SELECT * FROM t2 ORDER BY a LIMIT 5 OFFSET 6;
a
17
18
19
21
22
SELECT * FROM t1 UNION SELECT * FROM t2 ORDER BY a LIMIT 5;
a
11
12
13
14
15
SELECT * FROM t1 UNION SELECT * FROM t2 ORDER BY a LIMIT 5 OFFSET 6;
a
17
18
19
21
22
SELECT * FROM t1 UNION ALL SELECT * FROM t2 ORDER BY a LIMIT 5;
a
11
12
13
14
15
SELECT * FROM t1 UNION ALL SELECT * FROM t2 ORDER BY a LIMIT 5 OFFSET 6;
a
17
18
19
21
22
SELECT * FROM t1 UNION ALL SELECT * FROM t2 ORDER BY a LIMIT 5;
a
11
12
13
14
15
SELECT * FROM t1 UNION ALL SELECT * FROM t2 ORDER BY a LIMIT 5 OFFSET 6;
a
17
18
19
21
22
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
11
12
13
14
15
21
22
23
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
16
17
18
19
21
22
23
24
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
15
16
17
18
19
21
22
23
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
12
13
14
15
21
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
11
12
13
14
15
21
22
23
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
16
17
18
19
21
22
23
24
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
15
16
17
18
19
21
22
23
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
12
13
14
15
21
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
11
12
13
14
15
21
22
23
# Wrong result, should be 16-19, 21-24
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
16
17
18
19
21
22
23
24
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
15
16
17
18
19
21
22
23
# Wrong result, should be 14-11, 21-24
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
12
13
14
15
21
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
11
12
13
14
15
21
22
23
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
16
17
18
19
21
22
23
24
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8;
a
15
16
17
18
19
21
22
23
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION ALL
SELECT * FROM t2
ORDER BY a LIMIT 8 OFFSET 1;
a
12
13
14
15
21
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION
(SELECT * FROM t2 ORDER BY a LIMIT 4)
ORDER BY a LIMIT 7;
a
11
12
13
14
15
21
22
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION
(SELECT * FROM t2 ORDER BY a LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
16
17
18
19
23
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4)
ORDER BY a LIMIT 7;
a
15
16
17
18
19
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
12
13
14
15
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION
(SELECT * FROM t2 ORDER BY a LIMIT 4)
ORDER BY a LIMIT 7;
a
11
12
13
14
15
21
22
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION
(SELECT * FROM t2 ORDER BY a LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
16
17
18
19
23
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4)
ORDER BY a LIMIT 7;
a
15
16
17
18
19
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
12
13
14
15
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION ALL
(SELECT * FROM t2 ORDER BY a LIMIT 4)
ORDER BY a LIMIT 7;
a
11
12
13
14
15
21
22
# Wrong result, should be 16-19, 23-25
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION ALL
(SELECT * FROM t2 ORDER BY a LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
16
17
18
19
23
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION ALL
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4)
ORDER BY a LIMIT 7;
a
15
16
17
18
19
24
25
# Wrong result, should be 14-11, 25-23
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION ALL
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
12
13
14
15
22
23
24
(SELECT * FROM t1 ORDER BY a LIMIT 5) UNION ALL
(SELECT * FROM t2 ORDER BY a LIMIT 4)
ORDER BY a LIMIT 7;
a
11
12
13
14
15
21
22
(SELECT * FROM t1 ORDER BY a LIMIT 5 OFFSET 4) UNION ALL
(SELECT * FROM t2 ORDER BY a LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
16
17
18
19
23
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5) UNION ALL
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4)
ORDER BY a LIMIT 7;
a
15
16
17
18
19
24
25
(SELECT * FROM t1 ORDER BY a DESC LIMIT 5 OFFSET 4) UNION ALL
(SELECT * FROM t2 ORDER BY a DESC LIMIT 4 OFFSET 2)
ORDER BY a LIMIT 7 OFFSET 1;
a
12
13
14
15
22
23
24
DROP TABLE t1, t2;
select 0 limit 0;
0
create table t1 (a integer);
insert into t1 values (1);
select 1 as a from t1 union all select 1 from dual order by 1 limit 1;
a
1
(select 1 as a from t1) union all (select 1 from dual) order by 1 limit 1;
a
1
drop table t1;
create table t1 (a int);
insert into t1 values (1),(2),(3),(4),(5),(6),(7);
select count(*) c FROM t1 WHERE a > 0 ORDER BY c LIMIT 3;
c
7
select sum(a) c FROM t1 WHERE a > 0 ORDER BY c LIMIT 3;
c
28
drop table t1;
prepare s from "select 1 limit ?";
set @a='qwe';
execute s using @a;
1
set @a=-1;
execute s using @a;
ERROR HY000: Incorrect arguments to EXECUTE
prepare s from "select 1 limit 1, ?";
execute s using @a;
ERROR HY000: Incorrect arguments to EXECUTE
prepare s from "select 1 limit ?, ?";
execute s using @a, @a;
ERROR HY000: Incorrect arguments to EXECUTE
set @a=14632475938453979136;
execute s using @a, @a;
1
set @a=-14632475938453979136;
execute s using @a, @a;
ERROR HY000: Incorrect arguments to EXECUTE
End of 5.0 tests
select 1 as a limit 4294967296,10;
a
End of 5.1 tests
